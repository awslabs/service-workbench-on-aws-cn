"use strict";(self.webpackChunkservice_workbench_docusaurus=self.webpackChunkservice_workbench_docusaurus||[]).push([[6529],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),s=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),m=s(n),d=a,h=m["".concat(l,".").concat(d)]||m[d]||p[d]||o;return n?r.createElement(h,i(i({ref:t},u),{},{components:n})):r.createElement(h,i({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3919:function(e,t,n){function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return a}})},4996:function(e,t,n){n.d(t,{C:function(){return o},Z:function(){return i}});var r=n(2263),a=n(3919);function o(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var o=void 0===r?{}:r,i=o.forcePrependBaseUrl,c=void 0!==i&&i,l=o.absolute,s=void 0!==l&&l;if(!n)return n;if(n.startsWith("#"))return n;if((0,a.b)(n))return n;if(c)return t+n;var u=n.startsWith(t)?n:t+n.replace(/^\//,"");return s?e+u:u}(o,n,e,t)}}}function i(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},4505:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return p},default:function(){return d}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=n(4996),c=["components"],l={id:"link_aws_account",title:"Create or add an AWS Account",sidebar_label:"Create or add an AWS Account"},s=void 0,u={unversionedId:"deployment/post_deployment/link_aws_account",id:"deployment/post_deployment/link_aws_account",isDocsHomePage:!1,title:"Create or add an AWS Account",description:"There are two categories of AWS Account within Service Workbench: Internal accounts and External accounts.",source:"@site/docs/deployment/post_deployment/link_aws_account.md",sourceDirName:"deployment/post_deployment",slug:"/deployment/post_deployment/link_aws_account",permalink:"/service-workbench-on-aws-cn/deployment/post_deployment/link_aws_account",editUrl:"https://github.com/awslabs/go-research-on-aws/website/docs/deployment/post_deployment/link_aws_account.md",tags:[],version:"current",frontMatter:{id:"link_aws_account",title:"Create or add an AWS Account",sidebar_label:"Create or add an AWS Account"}},p=[{value:"Create AWS Organization",id:"create-aws-organization",children:[],level:2},{value:"Get Master Account Role ARN",id:"get-master-account-role-arn",children:[{value:"Create AWS Account",id:"create-aws-account",children:[],level:3}],level:2},{value:"Add External AWS Account",id:"add-external-aws-account",children:[],level:2}],m={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,c);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"There are two categories of AWS Account within Service Workbench: ",(0,o.kt)("strong",{parentName:"p"},"Internal accounts")," and ",(0,o.kt)("strong",{parentName:"p"},"External accounts"),". "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Internal accounts"),": Internal accounts are those linked to the AWS account from which you deployed Service Workbench. Users linked to an internal account will all be billed to that AWS account. "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"External accounts"),": External accounts supply their own AWS account, and users linked to an external account are billed to the external AWS account. This is how external researchers can collaborate and share data within Service Workbench, but remain responsible for their own billing.")),(0,o.kt)("p",null,"After logging in to the Service Workbench web interface for the first time as ",(0,o.kt)("strong",{parentName:"p"},"root")," user, perform the following actions: "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"From the sidebar, click \u2018",(0,o.kt)("strong",{parentName:"li"},"Accounts"),"\u2019 to display the \u2018",(0,o.kt)("strong",{parentName:"li"},"Accounts"),"\u2019 page. "),(0,o.kt)("li",{parentName:"ol"},"On the \u2018",(0,o.kt)("strong",{parentName:"li"},"Accounts"),"\u2019 page, create an ",(0,o.kt)("strong",{parentName:"li"},"AWS Account")," within Service Workbench.")),(0,o.kt)("h2",{id:"create-aws-organization"},"Create AWS Organization"),(0,o.kt)("p",null,"In the AWS Management Console, create an AWS Organization in the ",(0,o.kt)("strong",{parentName:"p"},"Master")," account. There is no configuration to set; Service Workbench will create a new account in the AWS Organization for this deployment, named after the ",(0,o.kt)("strong",{parentName:"p"},"Stage Name")," used at deployment. If you already created an AWS Organization, there is no further action required."),(0,o.kt)("h2",{id:"get-master-account-role-arn"},"Get Master Account Role ARN"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Read the file:  ",(0,o.kt)("inlineCode",{parentName:"li"},"main/solution/prepare-master-acc/README.md"),"."),(0,o.kt)("li",{parentName:"ol"},"Change directory to the ",(0,o.kt)("strong",{parentName:"li"},"root folder")," and run the command below. This command will take about 8 minutes to execute. ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"`scripts/master-account-deploy.sh <stage>` \n")),(0,o.kt)("p",null,"The output of this command is described in ",(0,o.kt)("strong",{parentName:"p"},"Figure 2"),"."),(0,o.kt)("img",{src:(0,i.Z)("img/deployment/post_deployment/service_information_00")}),"**_Figure 2: Service Information_** 3. Copy the value of the **Master Role ARN** from the output of the previous step. This value is the ARN of the newly created **Master** role.",(0,o.kt)("h3",{id:"create-aws-account"},"Create AWS Account"),(0,o.kt)("p",null,"This will create an account whose billing will go to the ",(0,o.kt)("strong",{parentName:"p"},"Main")," account. The ",(0,o.kt)("strong",{parentName:"p"},"Main")," account is the account in which Service Workbench is deployed. See ",(0,o.kt)("strong",{parentName:"p"},"Figure 3"),"."),(0,o.kt)("img",{src:(0,i.Z)("img/deployment/post_deployment/create_account_00.jpg")}),"**_Figure 3: Create AWS Account_**",(0,o.kt)("p",null,"To create the AWS Account, perform the following actions: "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In the Service Workbench console, navigate to \u2018",(0,o.kt)("strong",{parentName:"li"},"Accounts > AWS Accounts"),"\u2019 and click \u2018",(0,o.kt)("strong",{parentName:"li"},"Create AWS Account"),"\u2019. "),(0,o.kt)("li",{parentName:"ol"},"Specify the following details:\n\u2013\tIn \u2018",(0,o.kt)("strong",{parentName:"li"},"Role ARN"),"\u2019, fill in the ",(0,o.kt)("strong",{parentName:"li"},"Master Role ARN")," copied from the previous step.\n\u2013\tThe ",(0,o.kt)("strong",{parentName:"li"},"email address")," that you specify here must be unique within the AWS Organization.\n\u2013\tThe ",(0,o.kt)("strong",{parentName:"li"},"External ID")," by default is the string workbench. See ",(0,o.kt)("a",{parentName:"li",href:"/deployment/reference/iam_role"},"IAM Role")," for information on how to configure this to another value.")),(0,o.kt)("p",null,"After a minute, the following information displays in the \u2018",(0,o.kt)("strong",{parentName:"p"},"AWS Accounts"),"\u2019 tab:\n\u2013\t\u201c",(0,o.kt)("em",{parentName:"p"},"Trying to create accountID: xxx"),"\u201d.\n\u2013\tA workflow is in progress in \u2018",(0,o.kt)("strong",{parentName:"p"},"Workflows > Provision Account"),"\u2019 (see the sidebar's \u2018Accounts\u2019 page.)"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},(0,o.kt)("strong",{parentName:"em"},"Note"),": If instead you see an error message such as, \u201cStop Internal State Account ID not found\u201d, check the AWS Organization in the console of your ",(0,o.kt)("strong",{parentName:"em"},"Master")," account. Your account must not belong to an existing AWS Organization. You must either have an existing AWS Organization or be able to create a new AWS Organization.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Optionally, in the AWS console, you can inspect the following resources deployed by this script:\n\u2013\tIn AWS CloudFormation, a stack prep-master will be running. It creates the ",(0,o.kt)("strong",{parentName:"li"},"Master")," role and its output is the ",(0,o.kt)("strong",{parentName:"li"},"Master Role ARN"),".\n\u2013\tIn AWS Organization, the new account will display in the ",(0,o.kt)("strong",{parentName:"li"},"Master")," account\n\u2013\tIn AWS IAM, the new ",(0,o.kt)("strong",{parentName:"li"},"Master")," role will be created.\nOnce you add the account, it gets listed in \u2018",(0,o.kt)("strong",{parentName:"li"},"AWS Accounts"),"\u2019 as shown in ",(0,o.kt)("strong",{parentName:"li"},"Figure 4"),".")),(0,o.kt)("img",{src:(0,i.Z)("img/deployment/post_deployment/create_account_02.jpg")}),"**_Figure 4: Example of an AWS Account_**",(0,o.kt)("h2",{id:"add-external-aws-account"},"Add External AWS Account"),(0,o.kt)("p",null,"This will create an account whose billing will go to an external AWS account, such as an external researcher."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Deploy the file below. It will output Role ARN, VPC ID, etc.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"addons/addon-base-raas/packages/base-raas-cfn-templates/src/templates/onboard-account.cfn.yml\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"In the Service Workbench administrative interface, click the \u2018",(0,o.kt)("strong",{parentName:"li"},"AWS Accounts"),"\u2019 tab of an administrator login. See ",(0,o.kt)("strong",{parentName:"li"},"Figure 5"),". "),(0,o.kt)("li",{parentName:"ol"},"Click \u2018",(0,o.kt)("strong",{parentName:"li"},"Add AWS Account"),"\u2019 and enter the account information.")),(0,o.kt)("img",{src:(0,i.Z)("img/deployment/post_deployment/create_account_01.jpg")}),"**_Figure 5: Add AWS Account_**")}d.isMDXComponent=!0}}]);